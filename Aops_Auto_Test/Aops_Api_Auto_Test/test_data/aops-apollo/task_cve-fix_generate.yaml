#生成cve修复任务
- case_name: 生成CVE修复任务-生成冷补丁修复任务，所有信息均正确
  data:
    task_name: CVE修复任务
    description: 修复以下1个CVE：CVE-2022-2586
    accepted: false
    check_items: []
    takeover: false
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $cold_installed_rpm
            available_rpm: $cold_available_rpm
            fix_way: coldpatch
  validate:
    code: 200
    data:
      - fix_way: coldpatch
        task_id: ^[A-Za-z0-9]{32}$$
    label: Succeed
    message: operation succeed
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-生成热补丁修复任务，所有信息均正确
  data:
    task_name: CVE修复任务
    description: 修复以下1个CVE：CVE-2022-2586
    accepted: false
    check_items: []
    takeover: false
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 200
    data:
      - fix_way: hotpatch
        task_id: ^[A-Za-z0-9]{32}$$
    label: Succeed
    message: operation succeed
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-生成热补丁修复,冷补丁收编任务，所有信息均正确
  data:
    task_name: CVE修复任务
    description: 修复以下1个CVE：CVE-2022-2586
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
          - installed_rpm: $cold_installed_rpm
            available_rpm: $cold_available_rpm
            fix_way: coldpatch
  validate:
    code: 200
    data:
      - fix_way: coldpatch
        task_id: ^[A-Za-z0-9]{32}$$
      - fix_way: hotpatch
        task_id: ^[A-Za-z0-9]{32}$$
    label: Succeed
    message: operation succeed
    sql: select count(*) from cve_fix_task

- case_name: 生成CVE修复任务-热补丁修复，takeover为true
  data:
    task_name: 热补丁修复，takeover为true
    description: cve修复任务
    accepted: false
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 200
    data:
      - fix_way: coldpatch
        task_id: ^[A-Za-z0-9]{32}$$
      - fix_way: hotpatch
        task_id: ^[A-Za-z0-9]{32}$$
    label: Succeed
    message: operation succeed
    sql: select count(*) from cve_fix_task

- case_name: 生成CVE修复任务-冷补丁修复，takeover为true
  data:
    task_name: 冷补丁修复，takeover为true
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $cold_installed_rpm
            available_rpm: $cold_installed_rpm
            fix_way: coldpatch
  validate:
    code: 200
    data:
      - fix_way: coldpatch
        task_id: ^[A-Za-z0-9]{32}$$
    label: Succeed
    message: operation succeed
    sql: select count(*) from cve_fix_task

- case_name: 生成CVE修复任务-task_name非str类型
  data:
    task_name: 1
    description: 修复以下1个CVE：CVE-2022-2586
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-task_name超过20个字符
  data:
    task_name: cve修复任务cve修复任务cve修复任务
    description: 修复以下1个CVE：CVE-2022-2586
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task

- case_name: 生成CVE修复任务-task_name为空
  data:
    task_name:
    description: 修复以下1个CVE：CVE-2022-2586
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task

- case_name: 生成CVE修复任务-description超过50个字符
  data:
    task_name: cve修复任务
    description: CVE修复任务CVE修复任务CVE修复任务CVE修复任务CVE修复任务CVE修复任务CVE修复任务Cd
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-description为空
  data:
    task_name: cve修复任务
    description:
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-description非str类型
  data:
    task_name: cve修复任务
    description: 123
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-cve_id不正确
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: non-exist
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-cve_id和host_id不匹配
  data:
    task_name: cve_id和host_id不匹配
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: CVE-2022-1000
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-cve_id为空
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id:
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-cve_id非str类型
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: 1
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-host_id为空
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id:
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task

- case_name: 生成CVE修复任务-host_id不存在
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: 100000
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-host_id非int类型
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: non-int
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-accepted非bool类型
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: nonbool
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-accepted为空
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted:
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-takeover为空
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover:
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-takeover非bool类型
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: nonbool
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-check_items为空
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items:
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-check_items非list类型
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: nonlist
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task

- case_name: 生成CVE修复任务-check_items元素不存在
  data:
    task_name: check_items元素不存在
    description: cve修复任务
    accepted: false
    check_items: ['non-exist']
    takeover: false
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 200
    data:
      - fix_way: hotpatch
        task_id: ^[A-Za-z0-9]{32}$$
    label: Succeed
    message: operation succeed
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-check_items元素为空字符
  data:
    task_name: check_items元素不存在
    description: cve修复任务
    accepted: true
    check_items: ['']
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
          - installed_rpm: $hot_installed_rpm
            available_rpm: $hot_available_rpm
            fix_way: hotpatch
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task

- case_name: 生成CVE修复任务-rpm为空list
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms: []
  validate:
    code: 200
    data:
      - fix_way: coldpatch
        task_id: ^[A-Za-z0-9]{32}$$
      - fix_way: hotpatch
        task_id: ^[A-Za-z0-9]{32}$$
    label: Succeed
    message: operation succeed
    sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-rpm为空
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info:
      - cve_id: '$cve_id'
        host_info:
          - host_id: $host_id
        rpms:
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task

- case_name: 生成CVE修复任务-info为空
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info:
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task

- case_name: 生成CVE修复任务-info为空list
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info: []
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task

- case_name: 生成CVE修复任务-info非list类型
  data:
    task_name: cve修复任务
    description: cve修复任务
    accepted: true
    check_items: []
    takeover: true
    info: non-list
  validate:
    code: 1000
    label: Param.Error
    message: request parameter error
    sql: select count(*) from cve_fix_task
