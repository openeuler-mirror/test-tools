#生成cve修复任务
- case_name: 热补丁移除任务-所有信息均正确
  data:
    task_name: 热补丁移除任务
    info:
      - host_id: $host_id
        cves:
          - cve_id: $cve_id
  validate:
      code: 200
      label: Succeed
      message: operation succeed
      data:
        task_id: ^[A-Za-z0-9]{32}$$
      sql: select count(*) from hotpatch_remove_task;

- case_name: 生成CVE修复任务-生成热补丁修复任务，所有信息均正确
  data:
      task_name: CVE修复任务
      description: 修复以下1个CVE：CVE-2022-2586
      accepted: false
      check_items: []
      takeover: false
      info:
        - cve_id: '$cve_id'
          host_info:
            - host_id: $host_id
          rpms:
            - installed_rpm: $hot_installed_rpm
              available_rpm: $hot_available_rpm
              fix_way: hotpatch
  validate:
      code: 200
      data:
        - fix_way: hotpatch
          task_id: ^[A-Za-z0-9]{32}$$
      label: Succeed
      message: operation succeed
      sql: select count(*) from cve_fix_task;

- case_name: 生成CVE修复任务-生成热补丁修复,冷补丁收编任务，所有信息均正确
  data:
      task_name: CVE修复任务
      description: 修复以下1个CVE：CVE-2022-2586
      accepted: true
      check_items: []
      takeover: true
      info:
        - cve_id: '$cve_id'
          host_info:
            - host_id: $host_id
          rpms:
            - installed_rpm: $hot_installed_rpm
              available_rpm: $hot_available_rpm
              fix_way: hotpatch
            - installed_rpm: $cold_installed_rpm
              available_rpm: $cold_available_rpm
              fix_way: coldpatch
  validate:
      code: 200
      data:
        - fix_way: coldpatch
          task_id: ^[A-Za-z0-9]{32}$$
        - fix_way: hotpatch
          task_id: ^[A-Za-z0-9]{32}$$
      label: Succeed
      message: operation succeed
      sql: select count(*) from cve_fix_task;

